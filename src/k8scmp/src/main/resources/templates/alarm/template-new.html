<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
	<head>
		<title>Unicorn Admin</title>
		<meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="stylesheet" th:href="@{/css/bootstrap.min.css}" />
		
		<link rel="stylesheet" th:href="@{/css/bootstrap-responsive.min.css}" />
		<link rel="stylesheet" th:href="@{/css/uniform.css}" />
		<link rel="stylesheet" th:href="@{/css/select2.css}" />		
		<link rel="stylesheet" th:href="@{/css/unicorn.main.css}" />
		<link rel="stylesheet" th:href="@{/css/unicorn.grey.css}" class="skin-color" />	
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	</head>
	
	<body>
		<div id="common-header"></div>
		
		<div id="content">
			<div id="content-header">
				<h2>新建规则</h2>
			</div>
			<div id="breadcrumb">
				<a href="#" class="current tip-bottom" title="新建规则">新建规则</a>
			</div>
			<div class="container-fluid">
				<div class="row-fluid" >
					<div class="span12">
						<div class="widget-box">
							<div class="widget-title">
								<span class="icon">
									<i class="icon-align-justify"></i>									
								</span>
								<!-- <h5>请输入用户信息</h5> -->
							</div>
							<div class="widget-content nopadding"><!-- th:object="${TemplateInfo}" -->
								<form class="form-horizontal" action="/alarm/create" th:object="${TemplateInfo}" method="post" name="create_template" id="create_template" novalidate="novalidate">
                                    <div class="control-group">
                                        <label class="control-label">报警规则名称</label>
                                        <div class="controls">
                                            <input id="templateName" name="templateName" type="text" th:field="*{templateName}"/>
                                        </div>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label">选择报警类型</label>
                                        <div class="controls">
                                            <select id="templateType" onchange="getHostOrDeploy();" th:field="*{templateType}">
                                            	<option id="host" selected="selected" value="host">主机</option>
                                            	<option id="deploy" value="deploy">容器</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="control-group" id="selectHost">
										<label class="control-label">选择报警主机组</label>
										<div class="controls">
											<select multiple="multiple" class="multiselect" name="hostGroupName" id="hostGroup" style="width: 864px;" th:field="*{hostGroupList}">	
												<option th:each="hostGroupBasic:${templateInfo.hostGroupList}" th:value="${hostGroupBasic.id}" 	
												th:selected="${#strings.contains(hostGroupBasic,hostGroupBasic.id)}"
												th:text="${hostGroupBasic.hostGroupName}" ></option>	
											</select>
										</div>
									</div>
									<div class="control-group" id="selectPod" hidden="hide">
											<label class="control-label">选择报警容器</label>
											<div class="controls" id="deploymentInfo" th:field="*{deploymentInfo}">
												<select id="clusterName" th:field="*{deploymentInfo.clusterName}">
													<option th:value="${templateInfo.deploymentInfo.clusterName}" th:text="${templateInfo.deploymentInfo.clusterName}" ></option>
												</select>
												<select id="hostEnv" th:field="*{deploymentInfo.hostEnv}">
													<option th:value="${templateInfo.deploymentInfo.hostEnv}" th:text="${templateInfo.deploymentInfo.hostEnv}"></option>
												</select>
												<select id="deploymentName" th:field="*{deploymentInfo.deploymentName}">
													<option th:value="${templateInfo.deploymentInfo.deploymentName}" th:text="${templateInfo.deploymentInfo.deploymentName}"></option>
												</select>
											</div>
									</div>
									<div class="control-group">
										<label class="control-label">添加报警逻辑</label>
										<div class="controls">
                                           <a title="添加报警逻辑" class="btn btn-primary" href="javascript:void(0);" onclick="showTemplate();">添加</a>
                                       		<br/>
                                       		<br/>
                                       		<div id="strategyList" ></div>
										</div>
									</div>
									
									<div class="control-group">
                                        <label class="control-label">指定报警用户</label>
                                        <div class="controls">
                                            <select multiple="multiple" class="multiselect" name="username" id="hostGroup" style="width: 864px;">	
												<option th:each="category:${templateInfo.userList}" th:value="${category.id}" 	
												th:selected="${#strings.contains(category.username,category.id)}"
												th:text="${category.username}" ></option>	
											</select>
                                        </div>
                                    </div>
                                    
                                    <div class="form-actions">
                                    	<a  class="btn tip-bottom" href="/alarm">返回</a>
                                        <input type="submit" value="提交" class="btn btn-primary" onclick=""/>
                                    </div>
                                </form>
							</div>
						</div>
					</div>
				</div>

				<div class="row-fluid">
					<div id="footer" class="span12">
						2017 &copy; k8scmp. 
					</div>
				</div>
			</div>
		</div>	


		<script th:src="@{/js/jquery.min.js}"></script>
		<script th:src="@{/js/jquery.ui.custom.js}"></script>
		<script th:src="@{/js/bootstrap.min.js}"></script>
		
		<script th:src="@{/js/jquery.uniform.js}"></script>
		<script th:src="@{/js/select2.min.js}"></script>
		<script th:src="@{/js/jquery.dataTables.min.js}"></script>
		<script th:src="@{/js/unicorn.js}"></script>
		<script th:src="@{/js/unicorn.tables.js}"></script>
		<script th:src="@{/js/commonDisplay.js}"></script>
		<script type="text/javascript">
			  
			function showTemplate(){
				
				var childdiv=$('<div></div>');  
				childdiv.attr("id","id" + new Date().getTime());
				$("#strategyList").append(childdiv);
				childdiv.load("/js/template-strategy.html #strategyInfo");
				
			}
			
			$(document).ready(function() {
		        
		        getHostOrDeploy();
		    });
			function getHostOrDeploy(){
				$("#templateType").change(function(){
	                 var hideselect = $(this).val();
	                 if(hideselect == "host"){
		 				$("#selectPod").hide();
		 				$("#selectHost").show();
	 					
	                 }else{
						$("#selectHost").hide();
						$("#selectPod").show();
	                 }
	             });
			}
			
		
		</script>
	</body>
</html>
